  private ScoreDoc[][] rerank(IndexSearcher searcher, int topN, ScoreDoc[] firstPassResults) throws IOException {
    ScoreDoc[][] reRankedPerModel = new ScoreDoc[rerankingQueries.length][topN];
    final List<LeafReaderContext> leaves = searcher.getIndexReader().leaves();
    LTRScoringQuery.ModelWeight[] modelWeights = new LTRScoringQuery.ModelWeight[rerankingQueries.length];
    for (int i = 0; i < rerankingQueries.length; i++) {
      if (originalRankingIndex == null || originalRankingIndex != i) {
        modelWeights[i] = (LTRScoringQuery.ModelWeight) searcher
            .createWeight(searcher.rewrite(rerankingQueries[i]), ScoreMode.COMPLETE, 1);
      }
    }
    scoreFeatures(searcher, topN, modelWeights, firstPassResults, leaves, reRankedPerModel);

    for (int i = 0; i < rerankingQueries.length; i++) {
      if (originalRankingIndex == null || originalRankingIndex != i) {
        sortByScore(reRankedPerModel[i]);
      }
    }

    return reRankedPerModel;
  }

