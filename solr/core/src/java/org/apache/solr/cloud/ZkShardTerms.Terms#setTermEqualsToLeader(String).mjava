    /**
     * Return a new {@link Terms} in which the term of {@code coreNodeName} is max
     * @param coreNodeName of the replica
     * @return null if term of {@code coreNodeName} is already maximum
     */
    Terms setTermEqualsToLeader(String coreNodeName) {
      long maxTerm = getMaxTerm();
      if (values.get(coreNodeName) == maxTerm) return null;

      HashMap<String, Long> newValues = new HashMap<>(values);
      newValues.put(coreNodeName, maxTerm);
      newValues.remove(recoveringTerm(coreNodeName));
      return new Terms(newValues, version);
    }

