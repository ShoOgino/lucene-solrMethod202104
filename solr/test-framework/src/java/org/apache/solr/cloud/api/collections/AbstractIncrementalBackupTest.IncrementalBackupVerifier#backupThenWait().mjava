        @SuppressWarnings("rawtypes")
        private void backupThenWait() throws SolrServerException, IOException {
            CollectionAdminRequest.Backup backup = CollectionAdminRequest.backupCollection(getCollectionName(), backupName)
                    .setLocation(backupLocation)
                    .setIncremental(true)
                    .setMaxNumberBackupPoints(maxNumberOfBackupToKeep)
                    .setRepositoryName(BACKUP_REPO_NAME);
            if (random().nextBoolean()) {
                try {
                    RequestStatusState state = backup.processAndWait(cluster.getSolrClient(), 1000);
                    assertEquals(RequestStatusState.COMPLETED, state);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                numBackup++;
            } else {
                CollectionAdminResponse rsp = backup.process(cluster.getSolrClient());
                assertEquals(0, rsp.getStatus());
                NamedList resp = (NamedList) rsp.getResponse().get("response");
                numBackup++;
                assertEquals(numBackup, resp.get("backupId"));;
            }
        }

