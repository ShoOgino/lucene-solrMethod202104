  public void testIncorrectlyUpdateChildDoc() throws Exception {
    SolrInputDocument doc = sdoc("id", "1",
        "child", sdoc("id", "2"));
    assertU(adoc(doc));
    assertU(commit());

    // did not add _root_ like we should have
    SolrException e = expectThrows(SolrException.class, () -> {
      addAndGetVersion(
          sdoc("id", "2", "grandchild", Collections.singletonMap("set", sdoc("id", "3"))), null);
    });
    assertTrue(e.toString(), e.getMessage().contains("Attempted an atomic/partial update to a " +
        "child doc without indicating the _root_ somehow."));
  }

