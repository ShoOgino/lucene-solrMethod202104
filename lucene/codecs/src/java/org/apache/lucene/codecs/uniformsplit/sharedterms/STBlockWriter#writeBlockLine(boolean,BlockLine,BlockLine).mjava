  @Override
  protected void writeBlockLine(
      boolean isIncrementalEncodingSeed, BlockLine line, BlockLine previousLine)
      throws IOException {
    blockLineWriter.writeLine(
        blockLinesWriteBuffer,
        line,
        previousLine,
        Math.toIntExact(termStatesWriteBuffer.size()),
        isIncrementalEncodingSeed);
    ((STBlockLine.Serializer) blockLineWriter)
        .writeLineTermStates(termStatesWriteBuffer, (STBlockLine) line, termStateSerializer);
    ((STBlockLine) line).collectFields(fieldsInBlock);
  }

