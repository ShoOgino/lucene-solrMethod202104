  @Override
  public final boolean incrementToken() throws IOException {
    if (input.incrementToken()) {
      for (PatternTypingRule rule : replacementAndFlagByPattern) {
        Matcher matcher = rule.getPattern().matcher(termAtt);
        if (matcher.find()) {
          // allow 2nd reset() and find() that occurs inside replaceFirst to avoid excess string creation
          typeAtt.setType(matcher.replaceFirst(rule.getTypeTemplate()));
          flagAtt.setFlags(rule.getFlags());
          return true;
        }
      }
      return true;
    }
    return false;
  }

