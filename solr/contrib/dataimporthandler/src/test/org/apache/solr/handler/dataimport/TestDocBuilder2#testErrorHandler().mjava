  @Test
  @SuppressWarnings({"unchecked"})
  public void testErrorHandler() throws Exception {
    @SuppressWarnings({"rawtypes"})
    List rows = new ArrayList();
    rows.add(createMap("id", "1", "FORCE_ERROR", "true"));
    MockDataSource.setIterator("select * from x", rows.iterator());

    runFullImport(DATA_CONFIG_WITH_ERROR_HANDLER);

    assertTrue("Error event listener was not called", ErrorEventListener.executed);
    assertTrue(ErrorEventListener.lastException.getMessage().contains("ForcedException"));
  }

