    @Override
    public Scorer scorer(AtomicReaderContext context,  ScorerContext scorerContext) throws IOException {
      final DocIdSetIterator disi;
      if (filter != null) {
        assert query == null;
        final DocIdSet dis = filter.getDocIdSet(context);
        if (dis == null)
          return null;
        disi = dis.iterator();
      } else {
        assert query != null && innerWeight != null;
        disi =
          innerWeight.scorer(context, scorerContext);
      }
      if (disi == null)
        return null;
      return new ConstantScorer(similarity, disi, this);
    }

