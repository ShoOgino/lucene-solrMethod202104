    private void testDeleteUnreferencedFiles(BackupRepository repository, BackupFilePaths paths,
                                             PurgeGraph purgeGraph) throws IOException {
        buildCompleteGraph(repository, paths, purgeGraph);
        String[] unRefBackupPoints = addUnRefFiles(repository, "b4_s", paths.getShardBackupMetadataDir());
        String[] unRefIndexFiles = addUnRefFiles(repository, "s4_", paths.getIndexDir());

        purgeGraph.findDeletableNodes(repository, paths);

        assertEquals(0, purgeGraph.backupIdDeletes.size());
        assertEquals(unRefBackupPoints.length, purgeGraph.shardBackupMetadataDeletes.size());
        assertTrue(purgeGraph.shardBackupMetadataDeletes.containsAll(Arrays.asList(unRefBackupPoints)));
        assertEquals(unRefIndexFiles.length, purgeGraph.indexFileDeletes.size());
        assertTrue(purgeGraph.indexFileDeletes.containsAll(Arrays.asList(unRefIndexFiles)));
    }

