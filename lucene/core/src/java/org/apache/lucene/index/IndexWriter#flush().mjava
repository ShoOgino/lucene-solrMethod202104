  /**
   * Moves all in-memory segments to the {@link Directory}, but does not commit (fsync) them (call
   * {@link #commit} for that).
   */
  public final void flush() throws IOException {
    flush(true, true);
  }

