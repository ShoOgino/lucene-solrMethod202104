    /** Writes one term's worth of postings. */
    public void write(BytesRef text, TermsEnum termsEnum) throws IOException {
      BlockTermState state = postingsWriter.writeTerm(text, termsEnum, docsSeen);
      if (state != null) {
        assert state.docFreq != 0;
        assert fieldInfo.getIndexOptions() == IndexOptions.DOCS_ONLY || state.totalTermFreq >= state.docFreq: "postingsWriter=" + postingsWriter;
        sumDocFreq += state.docFreq;
        sumTotalTermFreq += state.totalTermFreq;
        blockBuilder.add(Util.toIntsRef(text, scratchIntsRef), noOutputs.getNoOutput());

        PendingTerm term = new PendingTerm(BytesRef.deepCopyOf(text), state);
        pending.add(term);
        numTerms++;
      }
    }

