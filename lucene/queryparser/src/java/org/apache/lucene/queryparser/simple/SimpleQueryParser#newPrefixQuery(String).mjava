  /**
   * Factory method to generate a prefix query.
   */
  protected Query newPrefixQuery(String text) {
    BooleanQuery.Builder bq = new BooleanQuery.Builder();
    bq.setDisableCoord(true);
    for (Map.Entry<String,Float> entry : weights.entrySet()) {
      Query q = new PrefixQuery(new Term(entry.getKey(), text));
      float boost = entry.getValue();
      if (boost != 1f) {
        q = new BoostQuery(q, boost);
      }
      bq.add(q, BooleanClause.Occur.SHOULD);
    }
    return simplify(bq.build());
  }

