  public WeightedSumMetric(StreamExpression expression, StreamFactory factory) throws IOException {
    // grab all parameters out
    String functionName = expression.getFunctionName();
    if (!FUNC.equals(functionName)) {
      throw new IOException("Expected '" + FUNC + "' function but found " + functionName);
    }
    String valueCol = factory.getValueOperand(expression, 0);
    String countCol = factory.getValueOperand(expression, 1);
    String outputLong = factory.getValueOperand(expression, 2);

    // validate expression contains only what we want.
    if (null == valueCol) {
      throw new IOException(String.format(Locale.ROOT, "Invalid expression %s - expected %s(valueCol,countCol)", expression, FUNC));
    }

    boolean ol = false;
    if (outputLong != null) {
      ol = Boolean.parseBoolean(outputLong);
    }

    init(valueCol, countCol, ol);
  }

