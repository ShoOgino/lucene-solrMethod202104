  public void testFailOpenOldIndex() throws IOException {
    for (String name : oldNames) {
      Directory directory = oldIndexDirs.get(name);
      IndexCommit commit = DirectoryReader.listCommits(directory).get(0);
      IndexFormatTooOldException ex =
          expectThrows(
              IndexFormatTooOldException.class,
              () -> StandardDirectoryReader.open(commit, Version.LATEST.major));
      assertTrue(
          ex.getMessage()
              .contains(
                  "only supports reading from version " + Version.LATEST.major + " upwards."));
      // now open with allowed min version
      StandardDirectoryReader.open(commit, Version.LATEST.major - 1).close();
    }
  }

