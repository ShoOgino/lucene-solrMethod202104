  @Test
  public void jwksUrlwithHttpBehaviors() {
    
    HashMap<String, Object> issuerConfigMap = new HashMap<>();
    issuerConfigMap.put("name", "myName");
    issuerConfigMap.put("iss", "myIss");
    issuerConfigMap.put("jwksUrl", "http://host/jwk");

    JWTIssuerConfig issuerConfig = new JWTIssuerConfig(issuerConfigMap);
    
    SolrException e = expectThrows(SolrException.class, () -> issuerConfig.getHttpsJwks());
    assertEquals(400, e.code());
    assertEquals("jwksUrl is using http protocol. HTTPS required for IDP communication. Please use SSL or start your nodes with -Dsolr.auth.jwt.allowOutboundHttp=true to allow HTTP for test purposes.", e.getMessage());
    
    JWTIssuerConfig.ALLOW_OUTBOUND_HTTP = true;

    assertEquals(1, issuerConfig.getHttpsJwks().size());
    assertEquals("http://host/jwk", issuerConfig.getHttpsJwks().get(0).getLocation());    
  }

