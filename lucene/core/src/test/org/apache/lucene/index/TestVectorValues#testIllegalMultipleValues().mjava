  public void testIllegalMultipleValues() throws Exception {
    try (Directory dir = newDirectory();
         IndexWriter w = new IndexWriter(dir, createIndexWriterConfig())) {
      Document doc = new Document();
      doc.add(new VectorField("f", new float[4], ScoreFunction.DOT_PRODUCT));
      doc.add(new VectorField("f", new float[4], ScoreFunction.DOT_PRODUCT));
      IllegalArgumentException expected = expectThrows(IllegalArgumentException.class,
          () -> w.addDocument(doc));
      assertEquals("VectorValuesField \"f\" appears more than once in this document (only one value is allowed per field)",
          expected.getMessage());
    }
  }

