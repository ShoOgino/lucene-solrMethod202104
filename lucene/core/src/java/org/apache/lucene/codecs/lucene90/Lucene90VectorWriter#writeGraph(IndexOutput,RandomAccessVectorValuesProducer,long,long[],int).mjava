  private void writeGraph(IndexOutput graphData, RandomAccessVectorValuesProducer vectorValues, long graphDataOffset, long[] offsets, int count) throws IOException {
    HnswGraph graph = HnswGraphBuilder.build(vectorValues);
    for (int ord = 0; ord < count; ord++) {
      // write graph
      offsets[ord] = graphData.getFilePointer() - graphDataOffset;
      int[] arcs = graph.getNeighborNodes(ord);
      Arrays.sort(arcs);
      graphData.writeInt(arcs.length);
      int lastArc = -1;         // to make the assertion work?
      for (int arc : arcs) {
        assert arc > lastArc : "arcs out of order: " + lastArc + "," + arc;
        graphData.writeVInt(arc - lastArc);
        lastArc = arc;
      }
    }
  }

