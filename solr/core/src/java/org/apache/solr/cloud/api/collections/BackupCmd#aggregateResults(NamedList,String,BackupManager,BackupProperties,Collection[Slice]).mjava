  @SuppressWarnings({"rawtypes"})
  private NamedList aggregateResults(NamedList results, String collectionName,
                                     BackupManager backupManager,
                                     BackupProperties backupProps,
                                     Collection<Slice> slices) {
    NamedList<Object> aggRsp = new NamedList<>();
    aggRsp.add("collection", collectionName);
    aggRsp.add("numShards", slices.size());
    aggRsp.add("backupId", backupManager.getBackupId().id);
    aggRsp.add("indexVersion", backupProps.getIndexVersion());
    aggRsp.add("startTime", backupProps.getStartTime());

    double indexSizeMB = 0;
    NamedList shards = (NamedList) results.get("success");
    for (int i = 0; i < shards.size(); i++) {
      NamedList shardResp = (NamedList)((NamedList)shards.getVal(i)).get("response");
      if (shardResp == null)
        continue;
      indexSizeMB += (double) shardResp.get("indexSizeMB");
    }
    aggRsp.add("indexSizeMB", indexSizeMB);
    return aggRsp;
  }

