    @Override
    public synchronized void finish(int docCount) throws IOException {
      try {
        if (datOut != null)
          datOut.close();
      } finally {
        try {
          if (idxOut != null)
            idxOut.close();
        } finally {
          if (pool != null)
            pool.reset();
        }
      }
    }

