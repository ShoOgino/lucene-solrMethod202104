  final void writeBytes(int stream, byte[] b, int offset, int len) {
    // TODO: optimize
    final int end = offset + len;
    for (int i = offset; i < end; i++) writeByte(stream, b[i]);
  }

