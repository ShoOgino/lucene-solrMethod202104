  private int getHashCode(char[] text, int offset, int len) {
    if (text == null) throw new NullPointerException();
    if (ignoreCase) {
      int stop = offset + len;
      int code = 0;
      for (int i = offset; i < stop; ) {
        final int codePointAt = Character.codePointAt(text, i, stop);
        code = code * 31 + Character.toLowerCase(codePointAt);
        i += Character.charCount(codePointAt);
      }
      return code;
    }
    return CharsRef.stringHashCode(text, offset, len);
  }

