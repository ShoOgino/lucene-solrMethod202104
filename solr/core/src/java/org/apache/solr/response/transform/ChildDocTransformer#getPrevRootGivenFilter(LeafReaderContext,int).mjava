  private int getPrevRootGivenFilter(LeafReaderContext leafReaderContext, int segRootId) throws IOException {
    final BitSet segParentsBitSet = parentsFilter.getBitSet(leafReaderContext);
    if (segParentsBitSet != null) {
      return segRootId == 0 ? -1 : segParentsBitSet.prevSetBit(segRootId - 1);
    }
    throw new SolrException(SolrException.ErrorCode.BAD_REQUEST,
        "Parent filter '" + parentsFilter + "' doesn't match any parent documents");
  }

