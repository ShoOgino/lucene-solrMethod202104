  /**Get the changed replicas
   */
  public static Set<String> findModifiedReplicas(PerReplicaStates old, PerReplicaStates fresh) {
    Set<String> result = new HashSet<>();
    if (fresh == null) {
      old.states.forEachKey(result::add);
      return result;
    }
    old.states.forEachEntry((s, state) -> {
      // the state is modified or missing
      if (!Objects.equals(fresh.get(s) , state)) result.add(s);
    });
    fresh.states.forEachEntry((s, state) -> { if (old.get(s) == null ) result.add(s);
    });
    return result;
  }

