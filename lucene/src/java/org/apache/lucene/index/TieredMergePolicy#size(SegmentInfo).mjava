  // Segment size in bytes, pro-rated by % deleted
  private long size(SegmentInfo info) throws IOException {
    final long byteSize = info.sizeInBytes(true);    
    final int delCount = writer.get().numDeletedDocs(info);
    final double delRatio = (info.docCount <= 0 ? 0.0f : ((double)delCount / (double)info.docCount));    
    assert delRatio <= 1.0;
    return (long) (byteSize * (1.0-delRatio));
  }

