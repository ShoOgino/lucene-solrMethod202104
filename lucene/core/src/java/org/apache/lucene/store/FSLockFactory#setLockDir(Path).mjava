  /**
   * Set the lock directory. This method can be only called
   * once to initialize the lock directory. It is used by {@link FSDirectory}
   * to set the lock directory to itself.
   * Subclasses can also use this method to set the directory
   * in the constructor.
   */
  protected final void setLockDir(Path lockDir) throws IOException {
    if (this.lockDir != null)
      throw new IllegalStateException("You can set the lock directory for this factory only once.");
    if (lockDir != null) {
      Files.createDirectories(lockDir);
    }
    this.lockDir = lockDir;
  }

