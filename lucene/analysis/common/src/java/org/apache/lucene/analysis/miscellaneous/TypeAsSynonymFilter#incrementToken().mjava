  @Override
  public boolean incrementToken() throws IOException {
    if (savedToken != null) {         // Emit last token's type at the same position
      restoreState(savedToken);
      savedToken = null;
      termAtt.setEmpty();
      if (prefix != null) {
        termAtt.append(prefix);
      }
      termAtt.append(typeAtt.type());
      posIncrAtt.setPositionIncrement(0);
      // control what flags transfer to synonym
      flagsAtt.setFlags(flagsAtt.getFlags() & synFlagsMask);
      return true;
    } else if (input.incrementToken()) { // No pending token type to emit
      String type = typeAtt.type();
      if (ignore == null || !ignore.contains(type)) {
        savedToken = captureState();
      }
      return true;
    }
    return false;
  }

