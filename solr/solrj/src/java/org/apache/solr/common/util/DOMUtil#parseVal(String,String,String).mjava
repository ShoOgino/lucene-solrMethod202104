  private static Object parseVal(String type, String name, String textValue) {
    Object val = null;
    try {
      if ("str".equals(type)) {
        val = textValue;
      } else if ("int".equals(type)) {
        val = Integer.valueOf(textValue);
      } else if ("long".equals(type)) {
        val = Long.valueOf(textValue);
      } else if ("float".equals(type)) {
        val = Float.valueOf(textValue);
      } else if ("double".equals(type)) {
        val = Double.valueOf(textValue);
      } else if ("bool".equals(type)) {
        val = StrUtils.parseBool(textValue);
      }
      // :NOTE: Unexpected Node names are ignored
      // :TODO: should we generate an error here?
    } catch (NumberFormatException nfe) {
      throw new SolrException
        (SolrException.ErrorCode.SERVER_ERROR,
         "Value " + (null != name ? ("of '" + name + "' ") : "") +
         "can not be parsed as '" + type + "': \"" + textValue + "\"",
         nfe);
    }
    return val;
  }

