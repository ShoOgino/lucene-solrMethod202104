  private void transferBatchToBufferForOutput(MergeIterator mergeIterator,
                                              ExportBuffers.Buffer destination) throws IOException {
    try {
      int outDocsIndex = -1;
      for (int i = 0; i < batchSize; i++) {
        SortDoc sortDoc = mergeIterator.next();
        if (sortDoc != null) {
          destination.outDocs[++outDocsIndex].setValues(sortDoc);
        } else {
          break;
        }
      }
      destination.outDocsIndex = outDocsIndex;
    } catch (Throwable t) {
      log.error("transfer", t);
      if (t instanceof InterruptedException) {
        Thread.currentThread().interrupt();
      }
      throw t;
    } finally {

    }
  }

