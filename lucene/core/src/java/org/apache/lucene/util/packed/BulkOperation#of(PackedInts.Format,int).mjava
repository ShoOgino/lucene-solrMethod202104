  public static BulkOperation of(PackedInts.Format format, int bitsPerValue) {
    switch (format) {
      case PACKED:
        assert packedBulkOps[bitsPerValue - 1] != null;
        return packedBulkOps[bitsPerValue - 1];
      case PACKED_SINGLE_BLOCK:
        assert packedSingleBlockBulkOps[bitsPerValue - 1] != null;
        return packedSingleBlockBulkOps[bitsPerValue - 1];
      default:
        throw new AssertionError();
    }
  }

