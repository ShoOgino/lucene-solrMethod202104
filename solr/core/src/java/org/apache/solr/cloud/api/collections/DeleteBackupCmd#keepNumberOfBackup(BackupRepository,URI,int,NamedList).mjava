    /**
     * Keep most recent {@code  maxNumBackup} and delete the rest.
     */
    void keepNumberOfBackup(BackupRepository repository, URI backupPath,
                            int maxNumBackup,
                            @SuppressWarnings({"rawtypes"}) NamedList results) throws Exception {
        List<BackupId> backupIds = BackupFilePaths.findAllBackupIdsFromFileListing(repository.listAllOrEmpty(backupPath));
        if (backupIds.size() <= maxNumBackup) {
            return;
        }

        Collections.sort(backupIds);
        List<BackupId> backupIdDeletes = backupIds.subList(0, backupIds.size() - maxNumBackup);
        deleteBackupIds(backupPath, repository, new HashSet<>(backupIdDeletes), results);
    }

