  /** Writes & syncs to the Directory dir, taking care to
   *  remove the segments file on exception */
  final void commit(Directory dir) throws IOException {
    prepareCommit(dir);
    finishCommit(dir);
  }

