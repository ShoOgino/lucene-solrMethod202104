  @Override
  public void stop() {
    state = State.STOPPING;
    waitForExecutor.shutdownNow();
    try {
      waitForExecutor.awaitTermination(60, TimeUnit.SECONDS);
    } catch (InterruptedException e) {
      log.warn("Failed to shut down the waitFor executor - interrupted...");
      Thread.currentThread().interrupt();
    }
    waitForExecutor = null;
    state = State.STOPPED;
  }

