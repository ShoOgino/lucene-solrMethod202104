  /**
   * Wait for this helper to become ready.
   * @param timeout timeout value.
   * @param timeUnit timeout unit.
   * @throws InterruptedException on this thread being interrupted.
   * @throws TimeoutException when specified timeout has elapsed but the helper is not ready.
   */
  public void waitUntilReady(long timeout, TimeUnit timeUnit)
      throws InterruptedException, TimeoutException {
    boolean await = readyLatch.await(timeout, timeUnit);
    if (!await) {
      throw new TimeoutException("Timed out waiting for ClusterSingletons to become ready.");
    }
  }

