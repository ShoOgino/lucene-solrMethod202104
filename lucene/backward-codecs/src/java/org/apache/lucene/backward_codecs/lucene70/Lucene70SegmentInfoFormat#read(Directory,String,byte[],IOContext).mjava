  @Override
  public SegmentInfo read(Directory dir, String segment, byte[] segmentID, IOContext context)
      throws IOException {
    final String fileName =
        IndexFileNames.segmentFileName(segment, "", Lucene70SegmentInfoFormat.SI_EXTENSION);
    try (ChecksumIndexInput input = dir.openChecksumInput(fileName, context)) {
      Throwable priorE = null;
      SegmentInfo si = null;
      try {
        int format =
            CodecUtil.checkIndexHeader(
                input,
                Lucene70SegmentInfoFormat.CODEC_NAME,
                Lucene70SegmentInfoFormat.VERSION_START,
                Lucene70SegmentInfoFormat.VERSION_CURRENT,
                segmentID,
                "");

        si = parseSegmentInfo(dir, input, segment, segmentID);

      } catch (Throwable exception) {
        priorE = exception;
      } finally {
        CodecUtil.checkFooter(input, priorE);
      }
      return si;
    }
  }

