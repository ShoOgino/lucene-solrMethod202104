  private void ensureFieldHasValues(String identifyingDocId, String fieldName, Object... expectedValues) throws Exception {
    final ModifiableSolrParams solrParams = new ModifiableSolrParams();
    solrParams.set("id", identifyingDocId);
    QueryRequest request = new QueryRequest(solrParams);
    request.setPath("/get");
    final QueryResponse response = request.process(cluster.getSolrClient(), COLLECTION);

    final NamedList<Object> rawResponse = response.getResponse();
    assertTrue(rawResponse.get("doc") != null);
    assertTrue(rawResponse.get("doc") instanceof SolrDocument);
    final SolrDocument doc = (SolrDocument) rawResponse.get("doc");
    final Collection<Object> valuesAfterUpdate = doc.getFieldValues(fieldName);
    assertEquals("Expected field to have " + expectedValues.length + " values, but found " + valuesAfterUpdate.size(),
            expectedValues.length, valuesAfterUpdate.size());
    for (Object expectedValue: expectedValues) {
      assertTrue("Expected value [" + expectedValue + "] was not found in field", valuesAfterUpdate.contains(expectedValue));
    }
  }

