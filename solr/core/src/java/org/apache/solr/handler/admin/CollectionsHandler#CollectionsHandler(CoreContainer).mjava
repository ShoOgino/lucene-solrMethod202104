  /**
   * Overloaded ctor to inject CoreContainer into the handler.
   *
   * @param coreContainer Core Container of the solr webapp installed.
   */
  public CollectionsHandler(final CoreContainer coreContainer) {
    this.coreContainer = coreContainer;
    v2Handler = new CollectionHandlerApi(this);
    // Get the state change factory to know if need to enqueue to Overseer or process distributed.
    // Some SolrCloud tests do not need Zookeeper and end up with a null cloudConfig in NodeConfig (because
    // TestHarness.buildTestNodeConfig() uses the zkHost to decide it's SolrCloud).
    // These tests do not use Zookeeper and do not do state updates (see subclasses of TestBaseStatsCacheCloud).
    // Some non SolrCloud tests do not even pass a config at all, so let be cautious here (code is not pretty).
    // We do want to initialize here and not do it lazy to not deal with synchronization for actual prod code.
    if (coreContainer == null || coreContainer.getConfig() == null || coreContainer.getConfig().getCloudConfig() == null) {
      distributedClusterStateUpdater = null;
    } else {
      distributedClusterStateUpdater = new DistributedClusterStateUpdater(coreContainer.getConfig().getCloudConfig().getDistributedClusterStateUpdates());
    }
  }

