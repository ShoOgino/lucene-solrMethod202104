    @Override
    public void onEvent(ClusterEvent event) {
      if (state != State.RUNNING) {
        if (log.isDebugEnabled()) {
          log.debug("skipped event, not running: {}", event);
        }
        return;
      }
      if (event.getType() == ClusterEvent.EventType.COLLECTIONS_ADDED ||
          event.getType() == ClusterEvent.EventType.COLLECTIONS_REMOVED) {
        if (log.isDebugEnabled()) {
          log.debug("recorded event {}", Utils.toJSONString(event));
        }
        lastEvent = event;
        dummyEventLatch.countDown();
      } else {
        if (log.isDebugEnabled()) {
          log.debug("skipped event, wrong type: {}", event.getType());
        }
      }
    }

