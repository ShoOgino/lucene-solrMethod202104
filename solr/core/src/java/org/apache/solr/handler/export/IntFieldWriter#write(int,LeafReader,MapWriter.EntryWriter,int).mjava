  public boolean write(int docId, LeafReader reader, MapWriter.EntryWriter ew, int fieldIndex) throws IOException {
    NumericDocValues vals = DocValues.getNumeric(reader, this.field);
    int val;
    if (vals.advance(docId) == docId) {
      val = (int) vals.longValue();
    } else {
      return false;
    }
    ew.put(this.field, val);
    return true;
  }

