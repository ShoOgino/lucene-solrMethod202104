  protected void waitForBootstrapToComplete(String collectionName, String shardId) throws Exception {
    @SuppressWarnings({"rawtypes"})
    NamedList rsp;// we need to wait until bootstrap is complete otherwise the replicator thread will never start
    TimeOut timeOut = new TimeOut(60, TimeUnit.SECONDS, TimeSource.NANO_TIME);
    while (!timeOut.hasTimedOut())  {
      rsp = invokeCdcrAction(shardToLeaderJetty.get(collectionName).get(shardId), CdcrParams.CdcrAction.BOOTSTRAP_STATUS);
      if (rsp.get(RESPONSE_STATUS).toString().equals(COMPLETED))  {
        break;
      }
      Thread.sleep(1000);
    }
  }

