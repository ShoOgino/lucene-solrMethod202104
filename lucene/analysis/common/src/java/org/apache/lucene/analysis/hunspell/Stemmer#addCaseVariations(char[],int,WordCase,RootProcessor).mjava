  private void addCaseVariations(
      char[] word, int length, WordCase wordCase, RootProcessor processor) {
    if (wordCase == WordCase.UPPER) {
      caseFoldTitle(word, length);
      char[] aposCase = capitalizeAfterApostrophe(titleBuffer, length);
      if (aposCase != null) {
        if (!doStem(aposCase, 0, length, wordCase, WordContext.SIMPLE_WORD, processor)) {
          return;
        }
      }
      if (!doStem(titleBuffer, 0, length, wordCase, WordContext.SIMPLE_WORD, processor)) {
        return;
      }
      for (char[] variation : sharpSVariations(titleBuffer, length)) {
        if (!doStem(variation, 0, variation.length, null, WordContext.SIMPLE_WORD, processor)) {
          return;
        }
      }
    }

    if (dictionary.isDotICaseChangeDisallowed(word)) {
      return;
    }

    caseFoldLower(wordCase == WordCase.UPPER ? titleBuffer : word, length);
    if (!doStem(lowerBuffer, 0, length, wordCase, WordContext.SIMPLE_WORD, processor)) {
      return;
    }
    if (wordCase == WordCase.UPPER) {
      for (char[] variation : sharpSVariations(lowerBuffer, length)) {
        if (!doStem(variation, 0, variation.length, null, WordContext.SIMPLE_WORD, processor)) {
          return;
        }
      }
    }
  }

