    public SortDoc next() throws IOException {
      SortDoc _sortDoc = null;
      if (index > -1) {
        _sortDoc = outDocs[index--];
      } else {
        topDocs();
        if (index > -1) {
          _sortDoc = outDocs[index--];
        }
      }

      if (_sortDoc != null) {
        //Clear the bit so it's not loaded again.
        bits.clear(_sortDoc.docId);

        //Load the global ordinal (only matters for strings)
        _sortDoc.setGlobalValues(nextDoc);

        nextDoc.setValues(_sortDoc);
        //We are now done with this doc.
        _sortDoc.reset();
      } else {
        nextDoc = null;
      }
      return nextDoc;
    }

