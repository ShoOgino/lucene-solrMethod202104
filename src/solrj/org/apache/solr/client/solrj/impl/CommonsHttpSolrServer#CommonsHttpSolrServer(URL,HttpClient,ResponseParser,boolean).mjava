  /**
   * @see {@link #useMultiPartPost}, {@link #_parser}
   */
  public CommonsHttpSolrServer(URL baseURL, HttpClient client, ResponseParser parser, boolean useMultiPartPost) {
    _baseURL = baseURL.toExternalForm();
    if( _baseURL.endsWith( "/" ) ) {
      _baseURL = _baseURL.substring( 0, _baseURL.length()-1 );
    }
    if( _baseURL.indexOf( '?' ) >=0 ) {
      throw new RuntimeException( "Invalid base url for solrj.  The base URL must not contain parameters: "+_baseURL );
    }
 
    _httpClient = (client == null) ? new HttpClient(new MultiThreadedHttpConnectionManager()) : client;

    if (client == null) {
      // set some better defaults if we created a new connection manager and client
      
      // increase the default connections
      this.setDefaultMaxConnectionsPerHost( 32 );  // 2
      this.setMaxTotalConnections( 128 ); // 20
    }

    _parser = parser;
    
    this.useMultiPartPost = useMultiPartPost;
  }

