  protected void fireEvent(ClusterEvent event) {
    synchronized (listeners) {
      listeners.getOrDefault(event.getType(), Collections.emptySet())
          .forEach(listener -> {
            if (log.isDebugEnabled()) {
              log.debug("--- firing event {} to {}", event, listener);
            }
            listener.onEvent(event);
          });
    }
  }

