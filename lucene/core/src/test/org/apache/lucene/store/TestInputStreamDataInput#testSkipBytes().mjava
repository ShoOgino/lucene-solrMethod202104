  public void testSkipBytes() throws IOException {
    Random random = random();
    // not using the wrapped (NoReadInputStreamDataInput) here since we want to actually read and
    // verify
    InputStreamDataInput in = new InputStreamDataInput(new ByteArrayInputStream(RANDOM_DATA));
    int maxSkipTo = RANDOM_DATA.length - 1;
    // skip chunks of bytes until exhausted
    for (int curr = 0; curr < maxSkipTo; ) {
      int skipTo = TestUtil.nextInt(random, curr, maxSkipTo);
      int step = skipTo - curr;
      in.skipBytes(step);
      assertEquals(RANDOM_DATA[skipTo], in.readByte());
      curr = skipTo + 1; // +1 for read byte
    }
    in.close();
  }

