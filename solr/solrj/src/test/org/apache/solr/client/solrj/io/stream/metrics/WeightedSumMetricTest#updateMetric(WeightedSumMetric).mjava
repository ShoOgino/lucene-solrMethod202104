  private Number updateMetric(WeightedSumMetric wsum) {
    for (int i = 0; i < counts.length; i++) {
      Tuple t = new Tuple();
      t.put("avg", avg[i]);
      t.put("count", counts[i]);
      wsum.update(t);
    }
    return wsum.getValue();
  }

