  private void checkParameters(EngineParameters parameters) {
    ClusteringAlgorithm algorithm = engineContext.getAlgorithm(parameters.algorithmName());
    if (algorithm == null) {
      throw new SolrException(ErrorCode.BAD_REQUEST, String.format(Locale.ROOT,
          "Algorithm '%s' not found.",
          parameters.algorithmName()));
    }

    String defaultLanguage = parameters.language();
    LanguageComponents languageComponents = engineContext.getLanguage(defaultLanguage);
    if (languageComponents == null) {
      throw new SolrException(ErrorCode.BAD_REQUEST, String.format(Locale.ROOT,
          "Language '%s' is not supported.",
          defaultLanguage));
    }

    if (!algorithm.supports(languageComponents)) {
      throw new SolrException(ErrorCode.BAD_REQUEST, String.format(Locale.ROOT,
          "Language '%s' is not supported by algorithm '%s'.",
          defaultLanguage,
          parameters.algorithmName()));
    }

    if (parameters.fields().isEmpty()) {
      throw new SolrException(ErrorCode.BAD_REQUEST, String.format(Locale.ROOT,
          "At least one field name specifying content for clustering is required in parameter '%s'.",
          EngineParameters.PARAM_FIELDS));
    }
  }

