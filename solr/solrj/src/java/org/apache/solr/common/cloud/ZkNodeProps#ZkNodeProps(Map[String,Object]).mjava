  /**
   * Construct ZKNodeProps from map.
   */
  public ZkNodeProps(Map<String,Object> propMap) {
    this.propMap = propMap;

    // don't store base_url if we have a node_name to recompute from when we read back from ZK
    // sub-classes that know they need a base_url (Replica) can eagerly compute in their ctor
    if (!STORE_BASE_URL && this.propMap.containsKey(ZkStateReader.NODE_NAME_PROP)) {
      this.propMap.remove(ZkStateReader.BASE_URL_PROP);
    }

    // TODO: store an unmodifiable map, but in a way that guarantees not to wrap more than once.
    // Always wrapping introduces a memory leak.
  }

