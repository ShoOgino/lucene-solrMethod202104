  private DocCollection updatePerReplicaState(DocCollection c) {
    if (c == null || !c.isPerReplicaState()) return c;
    PerReplicaStates current = c.getPerReplicaStates();
    PerReplicaStates newPrs = PerReplicaStates.fetch(c.getZNode(), zkClient, current);
    if (newPrs != current) {
      if(log.isDebugEnabled()) {
        log.debug("update for a fresh per-replica-state {}", c.getName());
      }
      DocCollection modifiedColl = c.copyWith(newPrs);
      updateWatchedCollection(c.getName(), modifiedColl);
      return modifiedColl;
    } else {
      return c;
    }
  }

