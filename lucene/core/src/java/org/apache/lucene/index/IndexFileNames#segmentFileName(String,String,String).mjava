  /**
   * Returns a file name that includes the given segment name, your own custom name and extension.
   * The format of the filename is: &lt;segmentName&gt;(_&lt;name&gt;)(.&lt;ext&gt;).
   *
   * <p><b>NOTE:</b> .&lt;ext&gt; is added to the result file name only if <code>ext</code> is not
   * empty.
   *
   * <p><b>NOTE:</b> _&lt;segmentSuffix&gt; is added to the result file name only if it's not the
   * empty string
   *
   * <p><b>NOTE:</b> all custom files should be named using this method, or otherwise some
   * structures may fail to handle them properly (such as if they are added to compound files).
   */
  public static String segmentFileName(String segmentName, String segmentSuffix, String ext) {
    if (ext.length() > 0 || segmentSuffix.length() > 0) {
      assert !ext.startsWith(".");
      StringBuilder sb =
          new StringBuilder(segmentName.length() + 2 + segmentSuffix.length() + ext.length());
      sb.append(segmentName);
      if (segmentSuffix.length() > 0) {
        sb.append('_').append(segmentSuffix);
      }
      if (ext.length() > 0) {
        sb.append('.').append(ext);
      }
      return sb.toString();
    } else {
      return segmentName;
    }
  }

