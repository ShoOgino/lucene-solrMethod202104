  public void testReadNMinusTwoCommit() throws IOException {
    for (String name : this.unsupportedNames) {
      if (name.startsWith(Version.MIN_SUPPORTED_MAJOR - 1 + ".")) {
        Path oldIndexDir = createTempDir(name);
        TestUtil.unzip(getDataInputStream("unsupported." + name + ".zip"), oldIndexDir);
        try (BaseDirectoryWrapper dir = newFSDirectory(oldIndexDir)) {
          // don't checkindex, we don't have the codecs yet
          dir.setCheckIndexOnClose(false);
          IllegalArgumentException iae =
              expectThrows(IllegalArgumentException.class, () -> DirectoryReader.listCommits(dir));
          // TODO fix this once we have the codec for 7.0 recreated
          assertEquals(
              "Could not load codec 'Lucene70'. Did you forget to add lucene-backward-codecs.jar?",
              iae.getMessage());
          IllegalArgumentException ex =
              expectThrows(IllegalArgumentException.class, () -> DirectoryReader.listCommits(dir));
          assertEquals(
              "Could not load codec 'Lucene70'. Did you forget to add lucene-backward-codecs.jar?",
              ex.getMessage());
        }
      }
    }
  }

