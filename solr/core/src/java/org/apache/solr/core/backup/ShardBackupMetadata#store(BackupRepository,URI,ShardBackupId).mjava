    /**
     * Storing ShardBackupMetadata at {@code folderURI} with name {@code filename}.
     * If a file already existed there, overwrite it.
     */
    public void store(BackupRepository repository, URI folderURI, ShardBackupId shardBackupId) throws IOException {
        final String filename = shardBackupId.getBackupMetadataFilename();
        URI fileURI = repository.resolve(folderURI, filename);
        if (repository.exists(fileURI)) {
            repository.delete(folderURI, Collections.singleton(filename), true);
        }

        try (OutputStream os = repository.createOutput(repository.resolve(folderURI, filename))) {
            store(os);
        }
    }

