  protected void constructStreams() throws IOException {
    try {
      Object pushStream = ((Expressible) tupleStream).toExpression(streamFactory);
      final ModifiableSolrParams paramsLoc = new ModifiableSolrParams();
      paramsLoc.set(DISTRIB,"false"); // We are the aggregator.
      paramsLoc.set("expr", pushStream.toString());
      paramsLoc.set("qt","/export");
      paramsLoc.set("fl", fl);
      paramsLoc.set("sort", sort);
      paramsLoc.set("q", q);
      getReplicas(this.zkHost, this.collection, this.streamContext, paramsLoc).forEach(r -> {
        SolrStream solrStream = new SolrStream(r.getBaseUrl(), paramsLoc, r.getCoreName());
        solrStream.setStreamContext(streamContext);
        solrStreams.add(solrStream);
      });
    } catch (Exception e) {
      Throwable rootCause = ExceptionUtils.getRootCause(e);
      if (rootCause instanceof IOException) {
        throw (IOException)rootCause;
      } else {
        throw new IOException(e);
      }
    }
  }

