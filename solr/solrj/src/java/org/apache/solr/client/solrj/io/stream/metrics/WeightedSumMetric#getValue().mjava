  public Number getValue() {
    long total = sumCounts();
    double wavg = 0d;
    if (total > 0L) {
      for (Part next : parts) {
        wavg += next.weighted(total);
      }
    }
    return outputLong ? Math.round(wavg) : wavg;
  }

