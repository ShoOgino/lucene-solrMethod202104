  /**
  * Opens the stream to a single Solr instance.
  **/

  public void open() throws IOException {

    // Reuse the same client per node vs. having one per replica
    if(cache == null) {
      client = new HttpSolrClient.Builder(baseUrl).build();
    } else {
      client = cache.getHttpSolrClient(baseUrl);
    }

    try {
      SolrParams requestParams = loadParams(params);
      if (!distrib) {
        ((ModifiableSolrParams) requestParams).add("distrib","false");
      }
      tupleStreamParser = constructParser(requestParams);
    } catch (Exception e) {
      throw new IOException("params " + params, e);
    }
  }

