  public static float squareDistance(float[] v1, float[] v2) {
    assert v1.length == v2.length;
    float squareSum = 0.0f;
    int dim = v1.length;
    for (int i = 0; i < dim; i++) {
      float diff = v1[i] - v2[i];
      squareSum += diff * diff;
    }
    return squareSum;
  }

