    /**
     * Delete a replica entry from per-replica states
     *
     * @param replica name of the replica to be deleted
     */
    public static PerReplicaStatesOps deleteReplica(String replica, PerReplicaStates rs) {
        return new PerReplicaStatesOps(prs -> {
            List<PerReplicaStates.Operation> result;
            if (prs == null) {
                result = Collections.emptyList();
            } else {
                PerReplicaStates.State state = prs.get(replica);
                result = addDeleteStaleNodes(new ArrayList<>(), state);
            }
            return result;
        }).init(rs);
    }

