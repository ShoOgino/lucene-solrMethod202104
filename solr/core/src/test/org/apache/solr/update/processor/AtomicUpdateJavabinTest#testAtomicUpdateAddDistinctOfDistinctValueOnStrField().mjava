  @Test
  public void testAtomicUpdateAddDistinctOfDistinctValueOnStrField() throws Exception {
    ensureFieldHasValues(COMMITTED_DOC_ID, "title_s", "title_1", "title_2");
    atomicAddDistinctValueToField(COMMITTED_DOC_ID, "title_s", "title_3");
    ensureFieldHasValues(COMMITTED_DOC_ID, "title_s", "title_1", "title_2", "title_3");

    ensureFieldHasValues(UNCOMMITTED_DOC_ID, "title_s", "title_1", "title_2");
    atomicAddDistinctValueToField(UNCOMMITTED_DOC_ID, "title_s", "title_3");
    ensureFieldHasValues(UNCOMMITTED_DOC_ID, "title_s", "title_1", "title_2", "title_3");
  }

