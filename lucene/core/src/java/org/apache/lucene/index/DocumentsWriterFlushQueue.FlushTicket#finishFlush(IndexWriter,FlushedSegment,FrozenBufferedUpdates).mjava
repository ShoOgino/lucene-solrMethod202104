    protected final void finishFlush(IndexWriter indexWriter, FlushedSegment newSegment, FrozenBufferedUpdates bufferedUpdates)
            throws IOException {
      // Finish the flushed segment and publish it to IndexWriter
      if (newSegment == null) {
        if (bufferedUpdates != null && bufferedUpdates.any()) {
          indexWriter.publishFrozenUpdates(bufferedUpdates);
          if (indexWriter.infoStream.isEnabled("DW")) {
            indexWriter.infoStream.message("DW", "flush: push buffered updates: " + bufferedUpdates);
          }
        }
      } else {
        publishFlushedSegment(indexWriter, newSegment, bufferedUpdates);  
      }
    }

