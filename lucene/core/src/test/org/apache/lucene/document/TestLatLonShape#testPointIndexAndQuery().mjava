  public void testPointIndexAndQuery() throws Exception {
    Directory dir = newDirectory();
    RandomIndexWriter writer = new RandomIndexWriter(random(), dir);
    Document document = new Document();
    Point p = GeoTestUtil.nextPoint();
    double qLat =
        p.getLat() == GeoUtils.MAX_LAT_INCL
            ? p.getLat()
            : GeoEncodingUtils.decodeLatitude(GeoEncodingUtils.encodeLatitudeCeil(p.getLat()));
    double qLon =
        p.getLon() == GeoUtils.MAX_LON_INCL
            ? p.getLon()
            : GeoEncodingUtils.decodeLongitude(GeoEncodingUtils.encodeLongitudeCeil(p.getLon()));
    p = new Point(qLat, qLon);
    Field[] fields = LatLonShape.createIndexableFields(FIELDNAME, p.getLat(), p.getLon());
    for (Field f : fields) {
      document.add(f);
    }
    writer.addDocument(document);

    //// search
    IndexReader r = writer.getReader();
    writer.close();
    IndexSearcher s = newSearcher(r);

    // search by same point
    Query q =
        LatLonShape.newPointQuery(
            FIELDNAME, QueryRelation.INTERSECTS, new double[] {p.getLat(), p.getLon()});
    assertEquals(1, s.count(q));
    IOUtils.close(r, dir);
  }

