    @Test
    public void test() throws URISyntaxException, IOException {
        assumeWorkingMockito();
        BackupRepository repository = mock(BackupRepository.class);
        BackupFilePaths paths = mock(BackupFilePaths.class);
        when(paths.getBackupLocation()).thenReturn(new URI("/temp"));
        when(paths.getIndexDir()).thenReturn(new URI("/temp/index"));
        when(paths.getShardBackupMetadataDir()).thenReturn(new URI("/temp/backup_point"));

        PurgeGraph purgeGraph = new PurgeGraph();
        buildCompleteGraph(repository, paths, purgeGraph);
        purgeGraph.findDeletableNodes(repository, paths);

        assertEquals(0, purgeGraph.backupIdDeletes.size());
        assertEquals(0, purgeGraph.shardBackupMetadataDeletes.size());
        assertEquals(0, purgeGraph.indexFileDeletes.size());

        testDeleteUnreferencedFiles(repository, paths, purgeGraph);
        testMissingBackupPointFiles(repository, paths);
        testMissingIndexFiles(repository, paths);
    }

