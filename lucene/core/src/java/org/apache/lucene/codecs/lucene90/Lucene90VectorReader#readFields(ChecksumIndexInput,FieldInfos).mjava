  private void readFields(ChecksumIndexInput meta, FieldInfos infos) throws IOException {
    for (int fieldNumber = meta.readInt(); fieldNumber != -1; fieldNumber = meta.readInt()) {
      FieldInfo info = infos.fieldInfo(fieldNumber);
      if (info == null) {
        throw new CorruptIndexException("Invalid field number: " + fieldNumber, meta);
      }
      int scoreFunctionId = meta.readInt();
      if (scoreFunctionId < 0 || scoreFunctionId >= VectorValues.ScoreFunction.values().length) {
        throw new CorruptIndexException("Invalid score function id: " + scoreFunctionId, meta);
      }
      VectorValues.ScoreFunction scoreFunction = VectorValues.ScoreFunction.values()[scoreFunctionId];
      long vectorDataOffset = meta.readVLong();
      long vectorDataLength = meta.readVLong();
      int dimension = meta.readInt();
      int size = meta.readInt();
      int[] ordToDoc = new int[size];
      for (int i = 0; i < size; i++) {
        int doc = meta.readVInt();
        ordToDoc[i] = doc;
      }
      FieldEntry fieldEntry = new FieldEntry(dimension, scoreFunction, maxDoc, vectorDataOffset, vectorDataLength,
                                              ordToDoc);
      fields.put(info.name, fieldEntry);
    }
  }

