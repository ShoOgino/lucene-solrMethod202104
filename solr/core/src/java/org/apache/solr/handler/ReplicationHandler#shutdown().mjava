  public void shutdown() {
    startShutdownHook.preClose(core);
    startShutdownHook.postClose(core);
    finishShutdownHook.preClose(core);
    finishShutdownHook.postClose(core);

    ExecutorUtil.shutdownAndAwaitTermination(executorService);

    core.removeCloseHook(startShutdownHook);
    core.removeCloseHook(finishShutdownHook);
  }

