  // Opens up a pre-existing old taxonomy index and adds new BinaryDocValues based fields
  private void createNewTaxonomyIndex(String dirName) throws IOException {
    Path indexDir = createTempDir(oldTaxonomyIndexName);
    TestUtil.unzip(getDataInputStream(dirName + ".zip"), indexDir);
    Directory dir = newFSDirectory(indexDir);

    DirectoryTaxonomyWriter writer = new DirectoryTaxonomyWriter(dir);

    FacetLabel cp_b = new FacetLabel("b");
    writer.addCategory(cp_b);
    writer.getInternalIndexWriter().forceMerge(1);
    writer.commit();

    TaxonomyReader reader = new DirectoryTaxonomyReader(writer);

    int ord1 = reader.getOrdinal(new FacetLabel("a"));
    assert ord1 != TaxonomyReader.INVALID_ORDINAL;
    // Just asserting ord1 != TaxonomyReader.INVALID_ORDINAL is not enough to check compatibility
    assertNotNull(reader.getPath(ord1));

    int ord2 = reader.getOrdinal(cp_b);
    assert ord2 != TaxonomyReader.INVALID_ORDINAL;
    assertNotNull(reader.getPath(ord2));

    reader.close();
    writer.close();
    dir.close();
  }

