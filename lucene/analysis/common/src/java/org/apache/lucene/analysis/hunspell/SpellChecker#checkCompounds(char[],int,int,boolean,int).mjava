  private boolean checkCompounds(
      char[] chars, int offset, int length, boolean caseVariant, int depth) {
    if (depth > dictionary.compoundMax - 2) return false;

    int limit = length - dictionary.compoundMin + 1;
    for (int breakPos = dictionary.compoundMin; breakPos < limit; breakPos++) {
      WordContext context = depth == 0 ? WordContext.COMPOUND_BEGIN : WordContext.COMPOUND_MIDDLE;
      int breakOffset = offset + breakPos;
      if (checkCompoundCase(chars, breakOffset)
          && hasStems(chars, offset, breakPos, caseVariant, context)) {
        int remainingLength = length - breakPos;
        if (hasStems(chars, breakOffset, remainingLength, caseVariant, WordContext.COMPOUND_END)) {
          return true;
        }

        if (checkCompounds(chars, breakOffset, remainingLength, caseVariant, depth + 1)) {
          return true;
        }
      }
    }

    return false;
  }

