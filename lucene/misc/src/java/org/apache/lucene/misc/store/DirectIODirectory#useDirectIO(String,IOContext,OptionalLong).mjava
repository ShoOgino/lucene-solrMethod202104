  /**
   * Determines if direct IO should be used for a file. By default this tests if it is a merge
   * context and if the merge or file length extends the minimum size (see {@link
   * #DEFAULT_MIN_BYTES_DIRECT}). Subclasses may override method to enforce direct IO for specific
   * file types.
   *
   * @param name file name (unused by default implementation)
   * @param context information about merge size
   * @param fileLength if available, gives the file length. Will be empty when requesting an {@link
   *     IndexOutput}.
   * @return {@code true} if direct IO should be used; {@code false} if input/output should be
   *     requested from delegate directory.
   */
  protected boolean useDirectIO(String name, IOContext context, OptionalLong fileLength) {
    return context.context == Context.MERGE
        && context.mergeInfo.estimatedMergeBytes >= minBytesDirect
        && fileLength.orElse(minBytesDirect) >= minBytesDirect;
  }

