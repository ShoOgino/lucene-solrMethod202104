  @Test
  @BadApple(bugUrl = "https://issues.apache.org/jira/browse/SOLR-15011")
  public void proxyLoggingHandlerAllNodes() throws IOException, SolrServerException {
    CollectionAdminRequest.createCollection("collection", "conf", 2, 2).process(solrClient);
    ModifiableSolrParams mparams = new ModifiableSolrParams();

    mparams.set(CommonParams.QT, "/admin/logging");
    mparams.set("nodes", "all");
    mparams.set("set", "com.codahale.metrics.jmx.JmxReporter:WARN");
    solrClient.query("collection", mparams, SolrRequest.METHOD.GET);

    Set<String> nodes = solrClient.getClusterStateProvider().getLiveNodes();
    nodes.forEach(node -> {
      mparams.clear();
      mparams.set(CommonParams.QT, "/admin/logging");
      mparams.set("nodes", node);
      QueryResponse rsp = null;
      try {
        rsp = solrClient.query("collection", mparams, SolrRequest.METHOD.GET);
      } catch (Exception e) {
        fail("Exception while proxying request to node " + node);
      }
      NamedList<Object> nl = rsp.getResponse();
      assertEquals("WARN", ((SimpleOrderedMap) ((ArrayList)nl.get("loggers")).get(5)).get("level"));
    });
  }

