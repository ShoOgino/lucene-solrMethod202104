  /**
   * Verify that we get the *same* graph by indexing one segment as we do by indexing two segments
   * and merging.
   */
  public void testMergeProducesSameGraph() throws Exception {
    long seed = random().nextLong();
    int numDoc = atLeast(100);
    int dimension = atLeast(10);
    float[][] values = randomVectors(numDoc, dimension);
    int mergePoint = random().nextInt(numDoc);
    int[][] mergedGraph = getIndexedGraph(values, mergePoint, seed);
    int[][] singleSegmentGraph = getIndexedGraph(values, -1, seed);
    assertGraphEquals(singleSegmentGraph, mergedGraph);
  }

