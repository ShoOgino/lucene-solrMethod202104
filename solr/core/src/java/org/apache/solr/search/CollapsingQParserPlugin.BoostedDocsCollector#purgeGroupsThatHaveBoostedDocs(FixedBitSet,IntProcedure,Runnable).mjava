    /** 
     * Kludgy API neccessary to deal with diff collectors/strategies using diff
     * data structs for tracking collapse keys...
     */
    public void purgeGroupsThatHaveBoostedDocs(final FixedBitSet collapsedSet,
                                               final IntProcedure removeGroupKey,
                                               final Runnable resetNullGroupHead) {
      // Add the (collected) boosted docs to the collapsedSet
      boostedDocs.forEach(new IntProcedure() {
        public void apply(int globalDoc) {
          collapsedSet.set(globalDoc);
        }
      });
      // Remove any group heads that are in the same groups as (collected) boosted documents.
      boostedKeys.forEach(removeGroupKey);
      if (boostedNullGroup) {
        // If we're using IGNORE then no (matching) null docs were collected (by caller)
        // If we're using EXPAND then all (matching) null docs were already collected (by us)
        //   ...and that's *good* because each is treated like it's own group, our boosts don't matter
        // We only have to worry about removing null docs when using COLLAPSE, in which case any boosted null doc
        // means we clear the group head of the null group..
        resetNullGroupHead.run();
      }
    }

