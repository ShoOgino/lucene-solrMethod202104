  private static void assertSequentialIndex(Directory dir, int docNum, int segNum)
      throws IOException {
    HashSet<Long> seenOrds = new HashSet<>();
    IndexReader reader = DirectoryReader.open(dir);
    for (int i = 0; i < segNum; i++) {
      LeafReader leafReader = reader.leaves().get(i).reader();
      NumericDocValues numericDocValues = leafReader.getNumericDocValues("ord");

      assertTrue(numericDocValues.advanceExact(0));
      long lastOrd = numericDocValues.longValue();
      seenOrds.add(lastOrd);

      for (int doc = 1; doc < leafReader.numDocs(); doc++) {
        assertTrue(numericDocValues.advanceExact(doc));
        assertEquals(numericDocValues.longValue(), lastOrd + 1);
        lastOrd = numericDocValues.longValue();
        seenOrds.add(lastOrd);
      }
    }
    assertEquals(docNum, seenOrds.size());
    reader.close();
  }

