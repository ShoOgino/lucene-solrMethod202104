    BinaryFileVectors(Path filePath) throws IOException {
      in = FileChannel.open(filePath);
      long totalBytes = (long) numDocs * dim * Float.BYTES;
      if (totalBytes > Integer.MAX_VALUE) {
        throw new IllegalArgumentException("input over 2GB not supported");
      }
      int vectorByteSize = dim * Float.BYTES;
      size = (int) (totalBytes / vectorByteSize);
      mmap = in.map(FileChannel.MapMode.READ_ONLY, 0, totalBytes)
          .order(ByteOrder.LITTLE_ENDIAN)
          .asFloatBuffer();
    }

