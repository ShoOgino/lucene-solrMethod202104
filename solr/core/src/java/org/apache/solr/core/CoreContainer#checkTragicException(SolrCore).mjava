  /**
   * @param solrCore the core against which we check if there has been a tragic exception
   * @return whether this Solr core has tragic exception
   * @see org.apache.lucene.index.IndexWriter#getTragicException()
   */
  public boolean checkTragicException(SolrCore solrCore) {
    Throwable tragicException;
    try {
      tragicException = solrCore.getSolrCoreState().getTragicException();
    } catch (IOException e) {
      // failed to open an indexWriter
      tragicException = e;
    }

    if (tragicException != null && isZooKeeperAware()) {
      getZkController().giveupLeadership(solrCore.getCoreDescriptor());

      try {
        // If the error was something like a full file system disconnect, this probably won't help
        // But if it is a transient disk failure then it's worth a try
        solrCore.getSolrCoreState().newIndexWriter(solrCore, false); // should we rollback?
      } catch (IOException e) {
        log.warn("Could not roll index writer after tragedy");
      }
    }

    return tragicException != null;
  }

