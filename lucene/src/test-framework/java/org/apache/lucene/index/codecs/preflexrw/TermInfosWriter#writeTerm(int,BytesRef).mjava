  private void writeTerm(int fieldNumber, BytesRef term)
       throws IOException {

    //System.out.println("  tiw.write field=" + fieldNumber + " term=" + term.utf8ToString());

    // TODO: UTF16toUTF8 could tell us this prefix
    // Compute prefix in common with last term:
    int start = 0;
    final int limit = term.length < lastTerm.length ? term.length : lastTerm.length;
    while(start < limit) {
      if (term.bytes[start+term.offset] != lastTerm.bytes[start+lastTerm.offset])
        break;
      start++;
    }

    final int length = term.length - start;
    output.writeVInt(start);                     // write shared prefix length
    output.writeVInt(length);                  // write delta length
    output.writeBytes(term.bytes, start+term.offset, length);  // write delta bytes
    output.writeVInt(fieldNumber); // write field num
    lastTerm.copy(term);
  }

