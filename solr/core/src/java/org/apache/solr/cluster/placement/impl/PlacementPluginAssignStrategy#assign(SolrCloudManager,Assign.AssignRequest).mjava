  public List<ReplicaPosition> assign(SolrCloudManager solrCloudManager, Assign.AssignRequest assignRequest)
      throws Assign.AssignmentException, IOException, InterruptedException {

    PlacementContext placementContext = new SimplePlacementContextImpl(solrCloudManager);
    SolrCollection solrCollection = placementContext.getCluster().getCollection(collection.getName());

    PlacementRequestImpl placementRequest = PlacementRequestImpl.toPlacementRequest(placementContext.getCluster(), solrCollection, assignRequest);

    final PlacementPlan placementPlan;
    try {
      placementPlan = plugin.computePlacement(placementRequest, placementContext);
    } catch (PlacementException pe) {
      throw new Assign.AssignmentException(pe);
    }

    return ReplicaPlacementImpl.toReplicaPositions(placementPlan.getReplicaPlacements());
  }

