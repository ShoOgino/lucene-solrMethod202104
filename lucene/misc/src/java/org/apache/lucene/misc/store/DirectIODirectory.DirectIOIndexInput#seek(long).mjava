    @Override
    public void seek(long pos) throws IOException {
      if (pos != getFilePointer()) {
        final long alignedPos = pos - (pos % blockSize);
        filePos = alignedPos - buffer.capacity();

        final int delta = (int) (pos - alignedPos);
        refill(delta);
        buffer.position(delta);
      }
      assert pos == getFilePointer();
    }

