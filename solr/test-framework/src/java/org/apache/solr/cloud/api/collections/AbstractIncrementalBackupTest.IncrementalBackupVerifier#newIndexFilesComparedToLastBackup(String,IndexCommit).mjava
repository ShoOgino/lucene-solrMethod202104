        private Collection<String> newIndexFilesComparedToLastBackup(String shardName, IndexCommit currentCommit) throws IOException {
            Collection<String> oldFiles = lastShardCommitToBackupFiles.put(shardName, currentCommit.getFileNames());
            if (oldFiles == null)
                oldFiles = new ArrayList<>();

            List<String> newFiles = new ArrayList<>(currentCommit.getFileNames());
            newFiles.removeAll(oldFiles);
            return newFiles;
        }

