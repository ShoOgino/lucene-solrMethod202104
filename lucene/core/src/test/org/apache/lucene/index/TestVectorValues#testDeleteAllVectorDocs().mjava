  public void testDeleteAllVectorDocs() throws Exception {
    try (Directory dir = newDirectory();
         IndexWriter w = new IndexWriter(dir, createIndexWriterConfig())) {
      Document doc = new Document();
      doc.add(new StringField("id", "0", Store.NO));
      doc.add(new VectorField("v", new float[]{2, 3, 5}, ScoreFunction.DOT_PRODUCT));
      w.addDocument(doc);
      w.addDocument(new Document());
      w.commit();

      try (DirectoryReader r = w.getReader()) {
        assertNotNull(r.leaves().get(0).reader().getVectorValues("v"));
      }
      w.deleteDocuments(new Term("id", "0"));
      w.forceMerge(1);
      try (DirectoryReader r = w.getReader()) {
        assertNull(r.leaves().get(0).reader().getVectorValues("v"));
      }
    }
  }

