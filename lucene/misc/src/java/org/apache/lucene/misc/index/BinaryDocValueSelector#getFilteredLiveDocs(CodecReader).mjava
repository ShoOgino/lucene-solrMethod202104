  @Override
  public BitSet getFilteredLiveDocs(CodecReader reader) throws IOException {
    BinaryDocValues binaryDocValues = reader.getBinaryDocValues(field);
    Bits oldLiveDocs = reader.getLiveDocs();
    FixedBitSet bits = new FixedBitSet(reader.maxDoc());
    for (int i = 0; i < reader.maxDoc(); i++) {
      if (oldLiveDocs != null && oldLiveDocs.get(i) == false) {
        continue;
      }
      if (binaryDocValues.advanceExact(i)
          && keySet.contains(binaryDocValues.binaryValue().utf8ToString())) {
        bits.set(i);
      }
    }
    return bits;
  }

