  private Breaks parseBreaks(LineNumberReader reader, String line)
      throws IOException, ParseException {
    Set<String> starting = new LinkedHashSet<>();
    Set<String> ending = new LinkedHashSet<>();
    Set<String> middle = new LinkedHashSet<>();
    int num = Integer.parseInt(line.substring(BREAK_KEY.length()).trim());
    for (int i = 0; i < num; i++) {
      line = reader.readLine();
      String[] parts = line.split("\\s+");
      if (!line.startsWith(BREAK_KEY) || parts.length != 2) {
        throw new ParseException("BREAK chars expected", reader.getLineNumber());
      }
      String breakStr = parts[1];
      if (breakStr.startsWith("^")) {
        starting.add(breakStr.substring(1));
      } else if (breakStr.endsWith("$")) {
        ending.add(breakStr.substring(0, breakStr.length() - 1));
      } else {
        middle.add(breakStr);
      }
    }
    return new Breaks(starting, ending, middle);
  }

