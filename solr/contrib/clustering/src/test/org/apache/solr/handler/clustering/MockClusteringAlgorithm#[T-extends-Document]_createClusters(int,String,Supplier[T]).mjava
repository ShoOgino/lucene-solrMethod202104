  private <T extends Document> List<Cluster<T>> createClusters(int level, String prefix,
                                                               Supplier<T> docSupplier) {
    ArrayList<Cluster<T>> clusters = new ArrayList<>();
    for (int count = maxClusters.get(), idx = 1; count > 0; count--, idx++) {
      String label = prefix + (prefix.endsWith(" ") ? "" : ".") + idx;

      Cluster<T> c = new Cluster<>();
      c.addLabel(label);
      for (int cnt = 1, max = labelsPerCluster.get(); cnt < max; cnt++) {
        c.addLabel("Label " + cnt);
      }
      c.setScore(level * count * 0.01);

      if (level == 1) {
        for (int j = docsInCluster.get(); j > 0; j--) {
          c.addDocument(docSupplier.get());
        }
      } else {
        createClusters(level - 1, label, docSupplier).forEach(c::addCluster);
      }

      clusters.add(c);
    }
    return clusters;
  }

