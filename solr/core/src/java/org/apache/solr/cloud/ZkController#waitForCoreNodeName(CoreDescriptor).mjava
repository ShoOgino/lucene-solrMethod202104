  private void waitForCoreNodeName(CoreDescriptor descriptor) {
    log.debug("waitForCoreNodeName >>> look for our core node name");
    try {
      DocCollection collection = zkStateReader.waitForState(descriptor.getCollectionName(), 320L, TimeUnit.SECONDS,
        c -> ClusterStateMutator.getAssignedCoreNodeName(c, getNodeName(), descriptor.getName()) != null);
      // Read outside of the predicate to avoid multiple potential writes
      String name = ClusterStateMutator.getAssignedCoreNodeName(collection, getNodeName(), descriptor.getName());
      descriptor.getCloudDescriptor().setCoreNodeName(name);
    } catch (TimeoutException | InterruptedException e) {
      SolrZkClient.checkInterrupted(e);
      throw new SolrException(ErrorCode.SERVER_ERROR, "Failed waiting for collection state", e);
    }
    getCoreContainer().getCoresLocator().persist(getCoreContainer(), descriptor);
  }

